(this["webpackJsonpelasticsearch-taskview"]=this["webpackJsonpelasticsearch-taskview"]||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var l=n(0),a=n.n(l),r=n(3),c=n.n(r),u=(n(9),n(10),n(1)),o=function(e,t){return e.length>t?"".concat(e.substring(0,t),"..."):e},i=function(e){var t=e.task.task;if(!t)return"[no task details]";var n=t.status,l=n?n.updated+n.created+n.deleted:null,r=n.total-l,c=t.running_time_in_nanos/l/1e6,u=l/t.running_time_in_nanos*1e9;return n?a.a.createElement("div",null,a.a.createElement("progress",{value:l,max:n.total,style:{width:"500px"}}),a.a.createElement("br",null),"Velocity: ",u.toFixed(1)," docs/s",a.a.createElement("br",null),"Updated: ",n.updated," Created: ",n.created," Deleted: ",n.deleted," Total: ",n.total,a.a.createElement("br",null),"Remaining: ",r," ETA: ",new Date(c*r).toISOString().substr(11,8),a.a.createElement("br",null),"Description: ",a.a.createElement("code",{title:t.description},o(t.description,80))):null},s=function(e){var t=e.task,n=(e.clusterUrl,e.doAutoRefresh),r=e.clusterUrl+"/_tasks/"+t.node+":"+t.id,c=Object(l.useState)(),o=Object(u.a)(c,2),s=o[0],m=o[1],d=function(){fetch(r).then((function(e){return e.json()})).then((function(e){m(e)}))};Object(l.useEffect)((function(){console.log("looking at task "+JSON.stringify(t)),function(e){return!1===e.action.startsWith("cluster:monitor")}(t)&&(console.log("it was interesting"),d())}),[]);return Object(l.useEffect)((function(){return function e(){n&&(d(),setTimeout((function(){return e()}),1e4))}()}),[n]),a.a.createElement("div",null,a.a.createElement("table",{border:"1",style:{display:"inline-table"}},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"id"),a.a.createElement("th",null,"action"),a.a.createElement("th",null,"type"),a.a.createElement("th",null,"started"),a.a.createElement("th",null,"running time"),a.a.createElement("th",null,"cancellable"))),a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,t.id),a.a.createElement("td",null,t.action),a.a.createElement("td",null,t.type),a.a.createElement("td",null,new Date(t.start_time_in_millis).toLocaleTimeString()),a.a.createElement("td",null,new Date(t.running_time_in_nanos/1e6).toISOString().substr(11,8)),a.a.createElement("td",null,t.cancellable.toString())))),a.a.createElement("br",null),s?a.a.createElement(i,{task:s}):null)},m=function(e){var t=e.node,n=e.clusterUrl,l=e.doAutoRefresh,r=t.tasks?Object.keys(t.tasks).sort().map((function(e){return t.tasks[e]})).filter((function(e){return-1!==e.action.indexOf("reindex")})).map((function(e){return a.a.createElement(s,{key:e.id,task:e,clusterUrl:n,doAutoRefresh:l})})):null;return a.a.createElement("div",null,a.a.createElement("h3",null,t.name),"clusterUrl: ",n,"auto: ",l?"on":"off",a.a.createElement("ul",null,a.a.createElement("li",null,"ip: ",t.ip),a.a.createElement("li",null,"roles: ",JSON.stringify(t.roles))),"Tasks:",r)},d=function(){var e=Object(l.useState)(localStorage.getItem("clusterUrl")),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(l.useState)(),i=Object(u.a)(c,2),s=i[0],d=i[1],f=Object(l.useState)(!1),E=Object(u.a)(f,2),h=E[0],b=E[1],g=function(){localStorage.setItem("clusterUrl",n),fetch(n+"/_tasks").then((function(e){return e.json()})).then((function(e){d(e)}))};Object(l.useEffect)((function(){g()}),[]),Object(l.useEffect)((function(){h&&function e(){h&&(g(),setTimeout((function(){return e()}),1e4))}()}),[h]);var k=s?Object.keys(s.nodes).map((function(e){return a.a.createElement(m,{node:s.nodes[e],key:e,clusterUrl:n,doAutoRefresh:h})})):null;return a.a.createElement("div",null,a.a.createElement("h1",null,"Elasticsearch cluster @ ",n),a.a.createElement("span",null,"Cluster URL: ",a.a.createElement("input",{value:n,onChange:function(e){return r(e.target.value)}})),a.a.createElement("button",{onClick:g},"\u21bb Refresh"),a.a.createElement("label",null,a.a.createElement("input",{type:"checkbox",checked:h,onChange:function(e){return b(e.target.checked)}}),"Auto-refresh"),s?a.a.createElement("pre",{title:s},"Status: ",o(JSON.stringify(s),100)):null,k)};var f=function(){return a.a.createElement(d,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(f,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[4,1,2]]]);
//# sourceMappingURL=main.7f61e23c.chunk.js.map